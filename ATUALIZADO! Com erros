import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.HashSet;
import java.util.Random;
import java.util.Scanner;

//Tesouro
class PequenaConquista {
    private String nome;
    private int valorEmPontosDeConfianca;

    public PequenaConquista(String nome,int valorEmPontosDeConfianca) {
        this.nome = nome;
        this.valorEmPontosDeConfianca = valorEmPontosDeConfianca;
    }

    public int getLocalizacao() {
        return localizacao;
    }

    public void setLocalizacao(int localizacao) {
        this.localizacao = localizacao;
    }

    public String getNome() {
        return nome;
    }

    public int getValorEmPontosDeConfianca() {
        return valorEmPontosDeConfianca;
    }

    public void setNome(String nome) {
        this.nome = nome;
    }

    public void setValorEmPontosDeConfianca(int valorEmPontosDeConfianca) {
        this.valorEmPontosDeConfianca = valorEmPontosDeConfianca;
    }

    public String efeito() {
        return "Pequena conquista alcan√ßada!";
    }
}

class ConquistaAcademica extends PequenaConquista {
    public ConquistaAcademica(String nome, int valorEmPontosDeConfianca) {
        super(nome, valorEmPontosDeConfianca);
    }

    @Override
    public String efeito() {
        return "Um elogio recebido ou um problema resolvido aumentou sua confian√ßa! (" + getNome() + ")";
    }
}

class ConquistaPessoal extends PequenaConquista {
    public ConquistaPessoal(String nome, int valorEmPontosDeConfianca) {
        super(nome, valorEmPontosDeConfianca);
    }

    @Override
    public String efeito() {
        return "Um momento de autocuidado ou uma pequena vit√≥ria pessoal renovou suas energias! (" + getNome() + ")";
    }
}

class SuperacaoDeDesafio extends PequenaConquista {
    public SuperacaoDeDesafio(String nome, int valorEmPontosDeConfianca) {
        super(nome, valorEmPontosDeConfianca);
    }

    @Override
    public String efeito() {
        return "Voc√™ superou um desafio importante! Sua confian√ßa aumentou. (" + getNome() + ")";
    }
}

class ChaveDaAutoestima extends PequenaConquista {
    private int posicaoDesbloqueio; // Pode representar o ID de uma porta ou √°rea

    public ChaveDaAutoestima(String nome, int valorEmPontosDeConfianca, int posicaoDesbloqueio) {
        super(nome, valorEmPontosDeConfianca); // valorEmPontosDeConfianca pode ser 0 se for s√≥ chave
        this.posicaoDesbloqueio = posicaoDesbloqueio;
    }

    public int getPosicaoDesbloqueio() {
        return posicaoDesbloqueio;
    }

    @Override
    public String efeito() {
        return "Voc√™ encontrou a Chave da Autoestima: " + getNome() + "! Um novo caminho pode ter se aberto.";
    }
}

class Estudante {
    private String nome;
    private int localizacao;
    private List<PequenaConquista> pequenasConquistasColetadas;
    private int pontosDeConfianca;
    private String caracteristica; //NOVOOO

    public Estudante(String nome, int localizacao, int pontosDeConfiancaInicial) {
        this.nome = nome;
        this.localizacao = localizacao;
        this.pequenasConquistasColetadas = new ArrayList<>();
        this.pontosDeConfianca = pontosDeConfiancaInicial;
        this.caracteristica = "neutra";
    }

    public String getNome() {
        return nome;
    }

    public List<PequenaConquista> getPequenasConquistasColetadas() {
        return pequenasConquistasColetadas;
    }

    public int getLocalizacao(){
        return localizacao;
    }

    public int getPontosDeConfianca() {
        return pontosDeConfianca;
    }

    public void setCaracteristica(String caracteristica) {
        this.caracteristica = caracteristica;
    }

    public String getCaracteristica() {
        return caracteristica;
    }

    public void setNome(String nome) {
        this.nome = nome;
    }

    public void setLocalizacao(int localizacao) {
        this.localizacao = localizacao;
    }

    public void adicionarPequenaConquista(PequenaConquista conquista) {
        pequenasConquistasColetadas.add(conquista);
        this.pontosDeConfianca += conquista.getValorEmPontosDeConfianca();
        System.out.println(conquista.efeito());
    }

    public void perderConfianca(int valor) {
        this.pontosDeConfianca -= valor;
        if (this.pontosDeConfianca < 0) {
            this.pontosDeConfianca = 0;
        }
        System.out.println("Sua confian√ßa diminuiu para " + pontosDeConfianca);
    }

    public void recuperarConfianca(int valor) {
        this.pontosDeConfianca += valor;
        System.out.println("Sua confian√ßa aumentou para " + pontosDeConfianca);
    }
}

//Perigo
class PensamentoNegativo {
    private String nome;
    private int impactoConfianca; //Dano do perigo

    public PensamentoNegativo(String nome,  int impactoConfianca) {
        this.nome = nome;
        this.impactoConfianca = impactoConfianca;
    }

    public int getLocalizacao() {
        return localizacao;
    }

    public void setLocalizacao(int localizacao) {
        this.localizacao = localizacao;
    }

    public String getNome(){
        return nome;
    }

    public int getImpactoConfianca() {
        return impactoConfianca;
    }

    public void setImpactoConfianca(int impactoConfianca) {
        this.impactoConfianca = impactoConfianca;
    }

    public String efeito(Estudante estudante) {
        estudante.perderConfianca(this.impactoConfianca);
        return "Voc√™ foi confrontado por um Pensamento Negativo: " + nome + "!";
    }

    public void aumentarImpactoConfianca() { // NOVO
        this.impactoConfianca += 10; // Aumenta o dano para estudantes com ansiedade
    }
}

class AutocriticaExcessiva extends PensamentoNegativo {
    public AutocriticaExcessiva( int impactoConfianca) {
        super("Autocr√≠tica Excessiva", impactoConfianca);
    }

    @Override
    public String efeito(Estudante estudante) {
        super.efeito(estudante);
        return "A Autocr√≠tica Excessiva abalou sua confian√ßa! Voc√™ perdeu " + getImpactoConfianca() + " pontos de confian√ßa.";
    }
}

class MedoDeExposicao extends PensamentoNegativo {
    public MedoDeExposicao( int impactoConfianca) {
        super("Medo de Exposi√ß√£o",impactoConfianca);
    }

    @Override
    public String efeito(Estudante estudante) {
        super.efeito(estudante);
        return "O Medo de Exposi√ß√£o te deixou inseguro. Sua confian√ßa diminuiu em " + getImpactoConfianca() + " pontos.";
    }
}

class DuvidaParalisante extends PensamentoNegativo {
    public DuvidaParalisante( int impactoConfianca) {
        super("D√∫vida Paralisante", impactoConfianca);
    }

    @Override
    public String efeito(Estudante estudante) {
        super.efeito(estudante);
        return "A D√∫vida Paralisante te fez hesitar. Voc√™ perdeu " + getImpactoConfianca() + " pontos de confian√ßa e talvez um turno para refletir."; // Efeito de perder turno precisa ser implementado na l√≥gica do jogo
    }
}

class Labirinto {
    private List<PequenaConquista> pequenasConquistasDisponiveis;
    private List<PensamentoNegativo> pensamentosNegativos;
    private Set<Integer> salasTrancadas;
    private List<List<String>> estrutura;
    private int tamanho;

    public Labirinto(int tamanho) {
        this.tamanho = tamanho;
        this.pequenasConquistasDisponiveis = new ArrayList<>();
        this.pensamentosNegativos = new ArrayList<>();
        this.salasTrancadas = new HashSet<>();
        this.estrutura = new ArrayList<>();

        inicializarLabirinto();
        gerarLabirinto();
    }

    private void inicializarLabirinto() {

        pequenasConquistasDisponiveis.add(new ConquistaAcademica("Elogio do Professor", 3));
        pequenasConquistasDisponiveis.add(new ConquistaPessoal("Pausa para Relaxar", 7));
        pequenasConquistasDisponiveis.add(new SuperacaoDeDesafio("Entregar trabalho dif√≠cil", 10));
        pequenasConquistasDisponiveis.add(new ChaveDaAutoestima("Aceita√ß√£o das Imperfei√ß√µes", 5,  12)); // Chave para sala 12


        pensamentosNegativos.add(new AutocriticaExcessiva(4));
        pensamentosNegativos.add(new MedoDeExposicao( 5));
        pensamentosNegativos.add(new DuvidaParalisante(6));

        salasTrancadas.add(12); // Sala 12 est√° trancada
    }

    public void visualizarLabirinto(Estudante estudante) {
        int posEstudante = estudante.getLocalizacao();

        for (int i = 0; i < tamanho; i++) {
            for (int j = 0; j < tamanho; j++) {
                int posAtual = i * tamanho + j;

                if (posAtual == posEstudante) {
                    System.out.print("üòä ");
                } else if (!salaLiberada(posAtual)) {
                    System.out.print("‚òë ");
                } else if (encontrarTesouroNaPosicao(posAtual) != null) {
                    System.out.print("‚ù§ ");
                } else if (encontrarPerigoNaPosicao(posAtual) != null) {
                    System.out.print("‚ò† ");
                } else {
                    System.out.print("= ");
                }
            }
            System.out.println();
        }
    }

    public PequenaConquista encontrarPequenaConquistaNaPosicao(int posicao) {
        for (PequenaConquista pq : pequenasConquistasDisponiveis)
            if (pq.getLocalizacao() == posicao)
                return pq;
        return null;
    }

    public PensamentoNegativo encontrarPensamentoNegativoNaPosicao(int posicao) {
        for (PensamentoNegativo pn : pensamentosNegativos)
            if (pn.getLocalizacao() == posicao)
                return pn;
        return null;
    }

    public void removerPequenaConquista(PequenaConquista pq) {
        pequenasConquistasDisponiveis.remove(pq);
    }

    public void adicionarPequenaConquista(PequenaConquista pq) {
        pequenasConquistasDisponiveis.add(pq);
    }

    public boolean salaLiberada(int posicao) {
        return !salasTrancadas.contains(posicao);
    }

    public void desbloquearSala(int posicao) {
        salasTrancadas.remove(posicao);
        System.out.println("A sala " + posicao + " foi desbloqueada!");
    }

    public void adicionarPensamentoNegativo(PensamentoNegativo pn) {
        pensamentosNegativos.add(pn);
    }

    public void removerPensamentoNegativo(PensamentoNegativo pn) {
        pensamentosNegativos.remove(pn);
    }

    // Ainda precisa de adapta√ß√£o
    public void gerarLabirinto() {
        Random random = new Random();
        int totalSalas = tamanho * tamanho;

        PequenaConquista conquista = new ConquistaAcademica("Elogio do Professor", 3);
        int posicaoAleatoria = random.nextInt(totalSalas);
        conquista.setLocalizacao(posicaoAleatoria);
        pequenasConquistasDisponiveis.add(conquista);

        PensamentoNegativo pn = new AutocriticaExcessiva(4);
        int posicaoPn = random.nextInt(totalSalas);
        pn.setLocalizacao(posicaoPn);
        pensamentosNegativos.add(pn);


        for (int i = 0; i < tamanho; i++) {
            List<String> caminho = new ArrayList<>();
            for (int j = 0; j < tamanho; j++) {
                // Simplificando: '*' caminho livre, 'X' parede, 'P' jogador
                // A l√≥gica de gera√ß√£o precisa ser mais robusta
                if (random.nextInt(100) < 70) {
                    caminho.add("*"); // Caminho
                } else {
                    caminho.add("X"); // Parede
                }
            }
            estrutura.add(caminho);
        }
    }

}

//Classe principal
public class Estagiario {

    public static void digitando(String texto, int tempo_atraso) {
        for (char c : texto.toCharArray()) {
            System.out.print(c);
            try {
                Thread.sleep(tempo_atraso);
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
        }
        System.out.println();
    }

    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        int op = 0;

        digitando("Bem-vindo(a) ao Labirinto da Autoestima!", 30);

        while (true) {
            System.out.println("\nMenu Principal:");
            System.out.println("1 - Come√ßar Jornada");
            System.out.println("2 - Sair");
            System.out.print("Escolha uma op√ß√£o: ");
            if (sc.hasNextInt()) {
                op = sc.nextInt();
            } else {
                sc.next();
                System.out.println("Op√ß√£o inv√°lida. Por favor, insira um n√∫mero.");
                continue;
            }
            sc.nextLine();

            switch (op) {
                case 1:
                    digitando("Iniciando sua jornada de autoconhecimento...", 20);

                    System.out.print("Digite o nome do(a) estudante: ");
                    String nomeEstudante = sc.nextLine();

                    // Escolha de caracter√≠stica
                    System.out.println("\nEscolha uma caracter√≠stica que define seu personagem:");
                    System.out.println("1 - Maturidade (Conquistas melhores e narrativa mais reflexiva)");
                    System.out.println("2 - Ansiedade (Perigos mais intensos e narrativa mais tensa)");
                    System.out.println("3 - Sabedoria (Jogo mais f√°cil)");
                    System.out.print("Digite o n√∫mero correspondente √† caracter√≠stica: ");
                    int escolha = sc.nextInt();
                    sc.nextLine();

                    String caracteristica = "";
                    int confiancaInicial = 20;

                    switch (escolha) {
                        case 1:
                            caracteristica = "maturidade";
                            confiancaInicial += 10; // Conquistas dar√£o mais confian√ßa
                            digitando("Voc√™ escolheu Maturidade. Sua jornada ser√° profunda e suas conquistas mais significativas.", 30);
                            break;
                        case 2:
                            caracteristica = "ansiedade";
                            confiancaInicial -= 10; // Perigos mais fortes
                            digitando("Voc√™ escolheu Ansiedade. A jornada ser√° tensa e os perigos mais desafiadores, mas voc√™ √© forte!", 30);
                            break;
                        case 3:
                            caracteristica = "sabedoria";
                            confiancaInicial += 15; // Come√ßa mais preparado
                            digitando("Voc√™ escolheu Sabedoria. Sua experi√™ncia o ajudar√° a tomar decis√µes mais acertadas no labirinto.", 30);
                            break;
                        default:
                            caracteristica = "neutra";
                            digitando("Nenhuma caracter√≠stica especial foi escolhida. Boa sorte na sua jornada!", 30);
                    }

                    Estudante estudante = new Estudante(nomeEstudante, 0, confiancaInicial);
                    estudante.setCaracteristica(caracteristica); // Supondo que voc√™ tenha ou v√° criar esse setter

                    digitando("Ol√°, " + estudante.getNome() + ". Voc√™ se encontra em um labirinto que reflete seus desafios internos.", 20);
                    digitando("Sua confian√ßa atual √©: " + estudante.getPontosDeConfianca(), 20);
                    digitando("Colete 'Pequenas Conquistas' para aumentar sua confian√ßa e enfrente 'Pensamentos Negativos'.", 20);

                    Labirinto labirinto = new Labirinto(8);
                    labirinto.gerarLabirinto();

                    digitando("O labirinto foi gerado. A explora√ß√£o come√ßa agora!", 20);

                    // Simula intera√ß√µes com conquistas e perigos (voc√™ pode adaptar conforme a mec√¢nica)
                    PequenaConquista conquista = labirinto.encontrarPequenaConquistaNaPosicao(3);
                    if (conquista != null) {
                        if (caracteristica.equals("maturidade")) {
                            conquista.setBonus(15); // Ex: b√¥nus maior
                        }
                        estudante.adicionarPequenaConquista(conquista);
                        labirinto.removerPequenaConquista(conquista);
                        digitando("Confian√ßa atual: " + estudante.getPontosDeConfianca(), 20);
                    }

                    PensamentoNegativo pensamento = labirinto.encontrarPensamentoNegativoNaPosicao(4);
                    if (pensamento != null) {
                        if (caracteristica.equals("ansiedade")) {
                            pensamento.aumentarImpactoConfianca();
                        }
                        digitando(pensamento.efeito(estudante), 20);
                        digitando("Confian√ßa atual: " + estudante.getPontosDeConfianca(), 20);
                    }

                    digitando("\nLembre-se, " + estudante.getNome() + ", cada passo aqui √© um passo em dire√ß√£o a reconhecer seu valor.", 50);
                    digitando("Foco, resili√™ncia e autocompaix√£o ser√£o seus guias.", 50);

                    //aqui come√ßa o jogo msm
                    int posAtual = estudante.getLocalizacao();
                    boolean jogoAtivo = true;

                    while (jogoAtivo) {
                        labirinto.visualizarLabirinto(estudante);
                        digitando("\nVoc√™ est√° na posi√ß√£o " + posAtual + ". O que deseja fazer?", 30);
                        System.out.println("1 - ‚ñ≤");
                        System.out.println("2 - ‚ñº");
                        System.out.println("3 - ‚óÄ");
                        System.out.println("4 -  ‚ñ∫");
                        System.out.println("5 - ‚úò");

                        System.out.print("Escolha sua a√ß√£o: ");
                        int acao = sc.nextInt();
                        sc.nextLine();

                        int novaPos = posAtual;

                        switch (acao) {
                            case 1:
                                novaPos = posAtual - labirinto.getTamanho(); // andar "para frente" - subir linha
                                break;
                            case 2:
                                novaPos = posAtual + labirinto.getTamanho(); // andar "para tr√°s" - descer linha
                                break;
                            case 3:
                                novaPos = posAtual - 1; // andar para esquerda - diminuir coluna
                                break;
                            case 4:
                                novaPos = posAtual + 1; // andar para direita - aumentar coluna
                                break;
                            case 5:
                                digitando("Voc√™ decidiu sair da jornada. At√© a pr√≥xima!", 40);
                                jogoAtivo = false;
                                continue;
                            default:
                                digitando("Op√ß√£o inv√°lida. Tente novamente.", 30);
                                continue;
                        }

                        // Verifica se novaPos √© v√°lida
                        if (novaPos < 0 || novaPos >= labirinto.getTamanho() * labirinto.getTamanho() || !labirinto.salaLiberada(novaPos)) {
                            digitando("Voc√™ bateu numa parede invis√≠vel do seu medo. N√£o √© poss√≠vel seguir por aqui.", 40);
                            continue;
                        }

                        posAtual = novaPos;
                        estudante.setLocalizacao(posAtual);

                        // Verificar se tem pequena conquista na nova posi√ß√£o
                        PequenaConquista conquista = labirinto.encontrarPequenaConquistaNaPosicao(posAtual);
                        if (conquista != null) {
                            digitando("Voc√™ encontrou uma Pequena Conquista! " + conquista.getDescricao(), 40);
                            estudante.adicionarPequenaConquista(conquista);
                            labirinto.removerPequenaConquista(conquista);
                            digitando("Sua confian√ßa aumentou para: " + estudante.getPontosDeConfianca(), 30);
                        }

                        // Verificar se tem pensamento negativo
                        PensamentoNegativo pensamento = labirinto.encontrarPensamentoNegativoNaPosicao(posAtual);
                        if (pensamento != null) {
                            digitando("Um pensamento negativo surge: " + pensamento.getDescricao(), 40);
                            digitando(pensamento.efeito(estudante), 40);
                            digitando("Sua confian√ßa agora √©: " + estudante.getPontosDeConfianca(), 30);
                        }

                        // Verificar se tem perigo
                        Perigo perigo = labirinto.encontrarPerigoNaPosicao(posAtual);
                        if (perigo != null) {
                            digitando("Voc√™ se depara com um perigo: " + perigo.getDescricao(), 40);
                            // Exemplo de impacto do perigo: diminui confian√ßa
                            estudante.diminuiConfianca(perigo.getImpacto());
                            digitando("O perigo abalou sua confian√ßa para: " + estudante.getPontosDeConfianca(), 30);
                        }

                        // Voc√™ pode adicionar condi√ß√£o para terminar o jogo (confian√ßa zero ou sair do labirinto)
                        if (estudante.getPontosDeConfianca() <= 0) {
                            digitando("Sua confian√ßa chegou a zero. O labirinto interno ficou muito dif√≠cil... Mas nunca desista de voc√™!", 50);
                            jogoAtivo = false;
                        }
                    }

                    break;

                case 2:
                    digitando("Saindo do jogo. Lembre-se da sua for√ßa! At√© a pr√≥xima!", 50);
                    sc.close();
                    return;

                default:
                    digitando("Op√ß√£o inv√°lida. Tente novamente.", 50);
            }
        }
    }
}
